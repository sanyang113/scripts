//不速之客製做
var status = -1;
var useItem = 4030002;
var select = -1;
var qty = -1;

var rewards = [
    [1302143,1,3],
    [2040502,1,3],
    [2040505,1,3],
    [2040802,1,3],
    [2040002,1,3],
    [2040402,1,3],
    [2040602,1,3],
    [2040502,1,3],
    [2040505,1,3],
    [2040802,1,3],
    [2040002,1,3],
    [2040402,1,3],
    [2040602,1,3],
    [2040502,1,3],
    [2040505,1,3],
    [2040802,1,3],
    [2040002,1,3],
    [2040402,1,3],
    [2040602,1,3],
    [1032004,1,3],
    [1032005,1,3],
    [1032009,1,3],
    [1032006,1,3],
    [1032007,1,3],
    [1032010,1,3],
    [1032002,1,3],
    [1002026,1,3],
    [1002089,1,3],
    [1002090,1,3],
    [1032004,1,3],
    [1032005,1,3],
    [1032009,1,3],
    [1032006,1,3],
    [1032007,1,3],
    [1032010,1,3],
    [1032002,1,3],
    [1002026,1,3],
    [1002089,1,3],
    [1002090,1,3],
    [2000001,1,3],
    [2000002,1,3],
    [2000003,1,3],
    [2000006,1,3],
    [2000004,1,3],
    [2022000,1,3],
    [2022003,1,3],
    [2000001,1,3],
    [2000002,1,3],
    [2000003,1,3],
    [2000006,1,3],
    [2000004,1,3],
    [2022000,1,3],
    [2022003,1,3],
    [2000001,1,3],
    [2000002,1,3],
    [2000003,1,3],
    [2000006,1,3],
    [2000004,1,3],
    [2022000,1,3],
    [2022003,1,3],
    [4010000,1,3],
    [4010001,1,3],
    [4010002,1,3],
    [4010003,1,3],
    [4020007,1,3],
    [4020008,1,3],
    [4003000,1,3],
    [4010004,1,3],
    [4010005,1,3],
    [4010006,1,3],
    [4020000,1,3],
    [4020001,1,3],
    [4020002,1,3],
    [4020003,1,3],
    [4020004,1,3],
    [4020005,1,3],
    [4020006,1,3],
    [1072369,1,3],
    [4030002,1,3],
    [1072369,1,3],
    [4030002,1,3],
    [1072369,1,3],
    [4030002,1,3],
    [1072369,1,3],
    [4030002,1,3],
    [2040502,1,3],
    [2040505,1,3],
    [2040802,1,3],
    [2040002,1,3],
    [2040402,1,3],
    [2040602,1,3],
    [2040502,1,3],
    [2040505,1,3],
    [2040802,1,3],
    [2040002,1,3],
    [2040402,1,3],
    [2040602,1,3],
    [2040502,1,3],
    [2040505,1,3],
    [2040802,1,3],
    [2040002,1,3],
    [2040402,1,3],
    [2040602,1,3],
    [1032004,1,3],
    [1032005,1,3],
    [1032009,1,3],
    [1032006,1,3],
    [1032007,1,3],
    [1032010,1,3],
    [1032002,1,3],
    [1002026,1,3],
    [1002089,1,3],
    [1002090,1,3],
    [1032004,1,3],
    [1032005,1,3],
    [1032009,1,3],
    [1032006,1,3],
    [1032007,1,3],
    [1032010,1,3],
    [1032002,1,3],
    [1002026,1,3],
    [1002089,1,3],
    [1002090,1,3],
    [2000001,1,3],
    [2000002,1,3],
    [2000003,1,3],
    [2000006,1,3],
    [2000004,1,3],
    [2022000,1,3],
    [2022003,1,3],
    [2000001,1,3],
    [2000002,1,3],
    [2000003,1,3],
    [2000006,1,3],
    [2000004,1,3],
    [2022000,1,3],
    [2022003,1,3],
    [2000001,1,3],
    [2000002,1,3],
    [2000003,1,3],
    [2000006,1,3],
    [2000004,1,3],
    [2022000,1,3],
    [2022003,1,3],
    [4010000,1,3],
    [4010001,1,3],
    [4010002,1,3],
    [4010003,1,3],
    [4020007,1,3],
    [4020008,1,3],
    [4003000,1,3],
    [4010004,1,3],
    [4010005,1,3],
    [4010006,1,3],
    [4020000,1,3],
    [4020001,1,3],
    [4020002,1,3],
    [4020003,1,3],
    [4020004,1,3],
    [4020005,1,3],
    [4020006,1,3],
    [4030002,1,3],
    [1072369,1,3],
    [2450115,1,3],
    

]

function start() {
    action(1,0,0);
}

function action(mode,type,selection) {
    if (mode == 1) {
        status++;
    } else if (mode == 0) {
        cm.dispose();
        return;
    } else {
        cm.dispose();
        return;
    }


    switch(status) {
        case 0: 
            var msg = "你想要製做什麼呢？\r\n"
            msg += "製做出來的#b不速之客#k裝備素質為#r隨機浮動#k\r\n"
            for (var i = 0; i < rewards.length; i++) {
                msg += "#L" + i + "#使用#r" + rewards[i][2] + "#k個#i" + useItem + ":# #k製作 #b#i" + rewards[i][0] + ":##t" + rewards[i][0]  +":##k\r\n";
            }
            cm.sendOk(msg);
            break;
        case 1:
            select = selection;
            var item = rewards[select][0];
            if(Math.floor(item / 1000000) == 1) {
                cm.sendYesNo("確定要製做#b#i" + item + ":##t" + item + "##k嗎？");
                break;
            }
            var msg = "製做#b#i" + item + ":##t" + item + "##k，要製做幾組呢？";
            cm.sendGetNumber(msg,1,1,100);
            break;
        case 2:
            if(selection == -1) {
                qty = 1;
            } else {
                qty = selection;
            }
            var useAmount = rewards[select][2] * qty;
            if (!cm.haveItem(useItem,useAmount)){
                cm.sendOk("你的#i" + useItem + ":##t" + useItem + "#好像不夠...");
                cm.dispose();
                return;
            }
            if (!cm.canHold(rewards[select][0],(rewards[select][1] * qty))) {
                cm.sendOk("包包已經塞不下了。"+qty);
                cm.dispose();
                return;
            }
            cm.gainItem(useItem,-useAmount);
            cm.gainItem(rewards[select][0],(rewards[select][1] * qty),true);
            cm.sendOk("#b#i" + rewards[select][0] + ":##t" + rewards[select][0]  +"##r x" + (rewards[select][1] * qty) + "個#k，收下吧！\r\n");
            cm.dispose();
            return;
        default:
            cm.dispose();
    }
}